# midi-player
Python launcher of the animated MIDI player by [@cifkao](https://github.com/cifkao) &amp; [@magenta](https://github.com/magenta)


# Installation

```
pip install midi-player
```

# Usage

Only tested with Jupyter Notebooks & Colab, but uses no IPython dependencies so it *should* work in other contexts.
```python

from midi_player import MIDIPlayer
from midi_player.stylers import basic, cifka_advanced

midi_file_url = "https://magenta.github.io/magenta-js/music/demos/melody.mid"
midi_file = "data/test_midi.mid"

MIDIPlayer(midi_file_url, 400)  
MIDIPlayer(midi_file, 160, styler=cifka_advanced)
```

With `wandb`:
```python
import wandb

wandb.login()
wandb.init(project="midi-player")
mp = MIDIPlayer(midi_file, 300, viz_type="waterfall")
wandb.log(wandb.Html(mp.html))
wandb.finish()

```

See `examples/` for more.

# Documentation

TO-DO. Particularly, people will want to know how to add/customize their own "stylers". 
See `midi_player/*.py` for now ;-).

# Known Issues
* Not sure why the staff view is putting out 32nd notes / how to tell it to do 8th notes instead.


# Trying something crazy
Let's see if GitHub will render this player in the README:
<script src="https://cdn.jsdelivr.net/combine/npm/tone@14.7.58,npm/@magenta/music@1.23.1/es6/core.js,npm/focus-visible@5,npm/html-midi-player@1.5.0"></script>

<style>
/* Custom player style */
#section3 midi-player {
  display: block;
  width: inherit;
  margin: 4px;
  margin-bottom: 0;
}
#section3 midi-player::part(control-panel) {
  background: #ff5;
  border: 2px solid #000;
  border-radius: 10px 10px 0 0;
}
#section3 midi-player::part(play-button) {
  color: #353;
  border: 2px solid currentColor;
  background-color: #4d4;
  border-radius: 20px;
  transition: all 0.2s;
  content: 'hello';
}
#section3 midi-player::part(play-button):hover {
  color: #0a0;
  background-color: #5f5;
  border-radius: 10px;
}
#section3 midi-player::part(time) {
  font-family: monospace;
}

/* Custom visualizer style */
#section3 midi-visualizer .piano-roll-visualizer {
  background: #ffd;
  border: 2px solid black;
  border-top: none;
  border-radius: 0 0 10px 10px;
  margin: 4px;
  width: inherit;
  margin-top: 0;
  overflow: auto;
}
#section3 midi-visualizer svg rect.note {
  opacity: 0.6;
  stroke-width: 2;
}
#section3 midi-visualizer svg rect.note[data-instrument="0"]{
  fill: #e22;
  stroke: #500;
}
#section3 midi-visualizer svg rect.note[data-instrument="2"]{
  fill: #2ee;
  stroke: #055;
}
#section3 midi-visualizer svg rect.note[data-is-drum="true"]{
  fill: #888;
  stroke: #888;
}
#section3 midi-visualizer svg rect.note.active {
  opacity: 0.9;
  stroke: #000;
  stroke-width: 3;
}
</style>

<section id="section3">
<midi-player src=data:audio/midi;base64,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 sound-font visualizer="#section3 midi-visualizer"></midi-player>
<midi-visualizer src=data:audio/midi;base64,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 type=piano-roll></midi-visualizer>
</section>

...Guess not.
